const mysql = require('mysql2/promise');

async function populateCE1CE2Competencies() {
    let connection;
    
    try {
        console.log('üöÄ Populating CE1 and CE2 competencies...');
        
        // Create database connection
        connection = await mysql.createConnection({
            host: 'localhost',
            user: 'root',
            password: 'thisisREALLYIT29!',
            database: 'reved_kids',
            multipleStatements: true
        });
        
        console.log('‚úÖ Connected to database');
        
        // CE1 French Competencies (50 total)
        const ce1FrenchCompetencies = [
            // LECTURE ET D√âCODAGE (L1)
            { code: 'CE1.FR.L1.1', titre: 'Identifier des mots de mani√®re de plus en plus ais√©e', domaine: 'L1', description: 'Reconnaissance automatique des mots fr√©quents' },
            { code: 'CE1.FR.L1.2', titre: 'Reconna√Ætre les lettres muettes', domaine: 'L1', description: 'Identification des lettres muettes en fin de mot' },
            { code: 'CE1.FR.L1.3', titre: 'Distinguer les sons proches', domaine: 'L1', description: 'Diff√©renciation [f]/[v], [ch]/[j], [k]/[g]' },
            { code: 'CE1.FR.L1.4', titre: 'Produire des syllabes et les associer', domaine: 'L1', description: '√âcriture de mots complexes par syllabation' },
            { code: 'CE1.FR.L1.5', titre: 'M√©moriser des mots fr√©quents', domaine: 'L1', description: 'Automatisation de la lecture des mots courants' },
            { code: 'CE1.FR.L1.6', titre: 'Lire des mots nouveaux, m√™me difficiles', domaine: 'L1', description: 'D√©codage de mots inconnus' },
            
            // LECTURE FLUENTE (L2)
            { code: 'CE1.FR.L2.1', titre: 'Lire √† voix haute en respectant la ponctuation', domaine: 'L2', description: 'Lecture expressive avec intonation' },
            { code: 'CE1.FR.L2.2', titre: 'Adapter le ton et l\'intonation au sens', domaine: 'L2', description: 'Lecture expressive adapt√©e au contenu' },
            { code: 'CE1.FR.L2.3', titre: 'Lire avec fluidit√© des textes vari√©s', domaine: 'L2', description: 'Lecture rapide et pr√©cise' },
            { code: 'CE1.FR.L2.4', titre: 'Pratiquer la lecture expressive', domaine: 'L2', description: 'Interpr√©tation et mise en voix' },
            
            // TYPES DE TEXTES (L3)
            { code: 'CE1.FR.L3.1', titre: 'Lire des √©crits scolaires', domaine: 'L3', description: 'Consignes, emploi du temps' },
            { code: 'CE1.FR.L3.2', titre: 'Lire des √©crits fonctionnels', domaine: 'L3', description: 'Recettes, notices, modes d\'emploi' },
            { code: 'CE1.FR.L3.3', titre: 'Lire des textes de fiction', domaine: 'L3', description: 'Contes, histoires, romans' },
            { code: 'CE1.FR.L3.4', titre: 'Lire des textes documentaires', domaine: 'L3', description: 'Manuels, dictionnaire, encyclop√©die' },
            
            // COMPR√âHENSION (C1)
            { code: 'CE1.FR.C1.1', titre: 'Comprendre des textes courts', domaine: 'C1', description: 'Compr√©hension de textes simples' },
            { code: 'CE1.FR.C1.2', titre: 'Identifier les informations explicites', domaine: 'C1', description: 'Rep√©rage d\'informations directes' },
            { code: 'CE1.FR.C1.3', titre: 'Inf√©rer des informations implicites', domaine: 'C1', description: 'D√©duction d\'informations non explicites' },
            { code: 'CE1.FR.C1.4', titre: 'Comprendre les connecteurs logiques', domaine: 'C1', description: 'Mais, donc, parce que, alors' },
            
            // VOCABULAIRE (V1)
            { code: 'CE1.FR.V1.1', titre: 'Enrichir son vocabulaire', domaine: 'V1', description: 'Acquisition de nouveaux mots' },
            { code: 'CE1.FR.V1.2', titre: 'Comprendre les familles de mots', domaine: 'V1', description: 'Racines, pr√©fixes, suffixes' },
            { code: 'CE1.FR.V1.3', titre: 'Utiliser le dictionnaire', domaine: 'V1', description: 'Recherche et d√©finition de mots' },
            { code: 'CE1.FR.V1.4', titre: 'Comprendre les synonymes et antonymes', domaine: 'V1', description: 'Relations entre les mots' },
            
            // GRAMMAIRE (G1)
            { code: 'CE1.FR.G1.1', titre: 'Identifier les classes de mots', domaine: 'G1', description: 'Nom, verbe, adjectif, d√©terminant' },
            { code: 'CE1.FR.G1.2', titre: 'Comprendre les accords', domaine: 'G1', description: 'Accord sujet-verbe, nom-adjectif' },
            { code: 'CE1.FR.G1.3', titre: 'Identifier les temps verbaux', domaine: 'G1', description: 'Pr√©sent, pass√©, futur' },
            { code: 'CE1.FR.G1.4', titre: 'Comprendre la phrase', domaine: 'G1', description: 'Structure sujet-verbe-compl√©ment' },
            
            // ORTHOGRAPHE (O1)
            { code: 'CE1.FR.O1.1', titre: 'Ma√Ætriser l\'orthographe lexicale', domaine: 'O1', description: 'Orthographe des mots courants' },
            { code: 'CE1.FR.O1.2', titre: 'Ma√Ætriser l\'orthographe grammaticale', domaine: 'O1', description: 'Accords et terminaisons' },
            { code: 'CE1.FR.O1.3', titre: 'Utiliser les r√®gles d\'orthographe', domaine: 'O1', description: 'R√®gles de base et exceptions' },
            { code: 'CE1.FR.O1.4', titre: 'V√©rifier son orthographe', domaine: 'O1', description: 'Relecture et correction' },
            
            // √âCRITURE (E1)
            { code: 'CE1.FR.E1.1', titre: '√âcrire des phrases simples', domaine: 'E1', description: 'Production de phrases correctes' },
            { code: 'CE1.FR.E1.2', titre: '√âcrire des textes courts', domaine: 'E1', description: 'R√©cits, descriptions, explications' },
            { code: 'CE1.FR.E1.3', titre: 'Respecter la ponctuation', domaine: 'E1', description: 'Point, virgule, majuscule' },
            { code: 'CE1.FR.E1.4', titre: 'Organiser ses id√©es', domaine: 'E1', description: 'Plan, structure, coh√©rence' },
            
            // PRODUCTION D\'√âCRITS (E2)
            { code: 'CE1.FR.E2.1', titre: '√âcrire un r√©cit', domaine: 'E2', description: 'Histoire avec d√©but, milieu, fin' },
            { code: 'CE1.FR.E2.2', titre: '√âcrire une description', domaine: 'E2', description: 'Portrait, paysage, objet' },
            { code: 'CE1.FR.E2.3', titre: '√âcrire une explication', domaine: 'E2', description: 'Comment faire, pourquoi' },
            { code: 'CE1.FR.E2.4', titre: '√âcrire une lettre', domaine: 'E2', description: 'Correspondance personnelle' },
            
            // LITT√âRATURE (L4)
            { code: 'CE1.FR.L4.1', titre: 'D√©couvrir la litt√©rature jeunesse', domaine: 'L4', description: 'Albums, contes, po√©sies' },
            { code: 'CE1.FR.L4.2', titre: 'Comprendre les genres litt√©raires', domaine: 'L4', description: 'Conte, fable, po√®me' },
            { code: 'CE1.FR.L4.3', titre: 'Analyser les personnages', domaine: 'L4', description: 'Caract√©risation et √©volution' },
            { code: 'CE1.FR.L4.4', titre: 'Comprendre l\'implicite', domaine: 'L4', description: 'Sens cach√©, morale' },
            
            // CULTURE LITT√âRAIRE (C2)
            { code: 'CE1.FR.C2.1', titre: 'D√©couvrir les auteurs', domaine: 'C2', description: '√âcrivains et illustrateurs' },
            { code: 'CE1.FR.C2.2', titre: 'Comprendre les r√©f√©rences culturelles', domaine: 'C2', description: 'Contes traditionnels, l√©gendes' },
            { code: 'CE1.FR.C2.3', titre: 'Appr√©cier la beaut√© des textes', domaine: 'C2', description: 'Esth√©tique et plaisir de lire' },
            { code: 'CE1.FR.C2.4', titre: 'Partager ses lectures', domaine: 'C2', description: 'Pr√©sentation, d√©bat, √©change' },
            
            // M√âDIAS ET NUM√âRIQUE (M1)
            { code: 'CE1.FR.M1.1', titre: 'Utiliser les outils num√©riques', domaine: 'M1', description: 'Traitement de texte, recherche' },
            { code: 'CE1.FR.M1.2', titre: 'Comprendre les m√©dias', domaine: 'M1', description: 'Presse, radio, t√©l√©vision' },
            { code: 'CE1.FR.M1.3', titre: 'Produire des documents num√©riques', domaine: 'M1', description: 'Pr√©sentation, affiche, blog' },
            { code: 'CE1.FR.M1.4', titre: 'Respecter les droits d\'auteur', domaine: 'M1', description: 'Propri√©t√© intellectuelle' }
        ];
        
        // CE1 Math Competencies (65 total)
        const ce1MathCompetencies = [
            // NOMBRES ENTIERS (N1)
            { code: 'CE1.MA.N1.1', titre: 'Conna√Ætre les nombres jusqu\'√† 100', domaine: 'N1', description: 'Consolidation p√©riode 1' },
            { code: 'CE1.MA.N1.2', titre: 'Comprendre et utiliser les nombres jusqu\'√† 1000', domaine: 'N1', description: 'Objectif p√©riode 2' },
            { code: 'CE1.MA.N1.3', titre: 'Comparer, ordonner, encadrer les nombres jusqu\'√† 1000', domaine: 'N1', description: 'Relations entre nombres' },
            { code: 'CE1.MA.N1.4', titre: 'Rep√©rer et placer les nombres sur une droite gradu√©e', domaine: 'N1', description: 'Repr√©sentation graphique' },
            { code: 'CE1.MA.N1.5', titre: 'Utiliser les nombres ordinaux', domaine: 'N1', description: 'Rang, position' },
            
            // FRACTIONS (N2) - NOUVEAUT√â 2025
            { code: 'CE1.MA.N2.1', titre: 'Comprendre les fractions comme parties d\'un tout', domaine: 'N2', description: 'Concept de fraction' },
            { code: 'CE1.MA.N2.2', titre: 'Utiliser les fractions unitaires', domaine: 'N2', description: '1/2, 1/3, 1/4 d√®s p√©riode 2' },
            { code: 'CE1.MA.N2.3', titre: 'Comparer des fractions inf√©rieures ou √©gales √† 1', domaine: 'N2', description: 'Comparaison de fractions' },
            { code: 'CE1.MA.N2.4', titre: 'Additionner et soustraire des fractions de m√™me d√©nominateur', domaine: 'N2', description: 'Calculs avec fractions' },
            { code: 'CE1.MA.N2.5', titre: 'Lier fractions et mesures de grandeurs', domaine: 'N2', description: 'Fractions et mesures' },
            
            // CALCUL MENTAL ET AUTOMATISMES (N3)
            { code: 'CE1.MA.N3.1', titre: 'Ma√Ætriser les compl√©ments √† 10 et √† 100', domaine: 'N3', description: 'Automatismes de base' },
            { code: 'CE1.MA.N3.2', titre: 'Calculer mentalement les additions et soustractions simples', domaine: 'N3', description: 'Calcul mental rapide' },
            { code: 'CE1.MA.N3.3', titre: 'Conna√Ætre les tables de multiplication', domaine: 'N3', description: 'Tables 2, 5, 10' },
            { code: 'CE1.MA.N3.4', titre: 'D√©velopper la fluence en calcul mental', domaine: 'N3', description: 'Tests chronom√©tr√©s' },
            { code: 'CE1.MA.N3.5', titre: 'Utiliser les strat√©gies de calcul mental explicites', domaine: 'N3', description: 'Techniques de calcul' },
            
            // ADDITION ET SOUSTRACTION (N4)
            { code: 'CE1.MA.N4.1', titre: 'Additionner des nombres entiers', domaine: 'N4', description: 'Technique op√©ratoire' },
            { code: 'CE1.MA.N4.2', titre: 'Soustraire des nombres entiers', domaine: 'N4', description: 'Technique op√©ratoire' },
            { code: 'CE1.MA.N4.3', titre: 'R√©soudre des probl√®mes additifs', domaine: 'N4', description: 'Probl√®mes d\'addition' },
            { code: 'CE1.MA.N4.4', titre: 'R√©soudre des probl√®mes soustractifs', domaine: 'N4', description: 'Probl√®mes de soustraction' },
            { code: 'CE1.MA.N4.5', titre: 'V√©rifier ses calculs', domaine: 'N4', description: 'Contr√¥le et validation' },
            
            // MULTIPLICATION ET DIVISION (N5)
            { code: 'CE1.MA.N5.1', titre: 'Comprendre le sens de la multiplication', domaine: 'N5', description: 'Multiplication comme addition r√©p√©t√©e' },
            { code: 'CE1.MA.N5.2', titre: 'Multiplier des nombres entiers', domaine: 'N5', description: 'Technique op√©ratoire' },
            { code: 'CE1.MA.N5.3', titre: 'Comprendre le sens de la division', domaine: 'N5', description: 'Division comme partage' },
            { code: 'CE1.MA.N5.4', titre: 'Diviser des nombres entiers', domaine: 'N5', description: 'Technique op√©ratoire' },
            { code: 'CE1.MA.N5.5', titre: 'R√©soudre des probl√®mes multiplicatifs', domaine: 'N5', description: 'Probl√®mes de multiplication' },
            
            // G√âOM√âTRIE (G1)
            { code: 'CE1.MA.G1.1', titre: 'Reconna√Ætre et d√©crire des figures planes', domaine: 'G1', description: 'Carr√©, rectangle, triangle, cercle' },
            { code: 'CE1.MA.G1.2', titre: 'Reproduire des figures planes', domaine: 'G1', description: 'Construction g√©om√©trique' },
            { code: 'CE1.MA.G1.3', titre: 'Construire des figures planes', domaine: 'G1', description: 'Cr√©ation de figures' },
            { code: 'CE1.MA.G1.4', titre: 'Reconna√Ætre et d√©crire des solides', domaine: 'G1', description: 'Cube, pav√©, cylindre, sph√®re' },
            { code: 'CE1.MA.G1.5', titre: 'Reproduire des solides', domaine: 'G1', description: 'Construction de solides' },
            
            // MESURES (M1)
            { code: 'CE1.MA.M1.1', titre: 'Mesurer des longueurs', domaine: 'M1', description: 'M√®tre, centim√®tre' },
            { code: 'CE1.MA.M1.2', titre: 'Comparer des longueurs', domaine: 'M1', description: 'Comparaison de mesures' },
            { code: 'CE1.MA.M1.3', titre: 'Mesurer des masses', domaine: 'M1', description: 'Kilogramme, gramme' },
            { code: 'CE1.MA.M1.4', titre: 'Mesurer des capacit√©s', domaine: 'M1', description: 'Litre, centilitre' },
            { code: 'CE1.MA.M1.5', titre: 'Mesurer le temps', domaine: 'M1', description: 'Heure, minute, seconde' },
            
            // GRANDEURS ET MESURES (M2)
            { code: 'CE1.MA.M2.1', titre: 'Utiliser les unit√©s de mesure', domaine: 'M2', description: 'Unit√©s conventionnelles' },
            { code: 'CE1.MA.M2.2', titre: 'Convertir des unit√©s', domaine: 'M2', description: 'Changements d\'unit√©s' },
            { code: 'CE1.MA.M2.3', titre: 'R√©soudre des probl√®mes de mesures', domaine: 'M2', description: 'Probl√®mes de longueur, masse, capacit√©' },
            { code: 'CE1.MA.M2.4', titre: 'Estimer des mesures', domaine: 'M2', description: 'Approximation et estimation' },
            { code: 'CE1.MA.M2.5', titre: 'Utiliser des instruments de mesure', domaine: 'M2', description: 'R√®gle, balance, verre doseur' },
            
            // ESPACE ET G√âOM√âTRIE (G2)
            { code: 'CE1.MA.G2.1', titre: 'Se rep√©rer dans l\'espace', domaine: 'G2', description: 'Position, orientation' },
            { code: 'CE1.MA.G2.2', titre: 'D√©crire des d√©placements', domaine: 'G2', description: 'Mouvement, trajectoire' },
            { code: 'CE1.MA.G2.3', titre: 'Repr√©senter l\'espace', domaine: 'G2', description: 'Plan, carte, sch√©ma' },
            { code: 'CE1.MA.G2.4', titre: 'Utiliser un quadrillage', domaine: 'G2', description: 'Coordonn√©es, rep√©rage' },
            { code: 'CE1.MA.G2.5', titre: 'Reconna√Ætre des sym√©tries', domaine: 'G2', description: 'Axe de sym√©trie' },
            
            // DONN√âES ET STATISTIQUES (D1)
            { code: 'CE1.MA.D1.1', titre: 'Collecter des donn√©es', domaine: 'D1', description: 'Recueil d\'informations' },
            { code: 'CE1.MA.D1.2', titre: 'Organiser des donn√©es', domaine: 'D1', description: 'Classement, tri' },
            { code: 'CE1.MA.D1.3', titre: 'Repr√©senter des donn√©es', domaine: 'D1', description: 'Graphiques, tableaux' },
            { code: 'CE1.MA.D1.4', titre: 'Lire des repr√©sentations', domaine: 'D1', description: 'Interpr√©tation de donn√©es' },
            { code: 'CE1.MA.D1.5', titre: 'Analyser des donn√©es', domaine: 'D1', description: 'Comparaison, conclusion' },
            
            // PROBL√àMES (P1)
            { code: 'CE1.MA.P1.1', titre: 'Comprendre un probl√®me', domaine: 'P1', description: 'Analyse de la situation' },
            { code: 'CE1.MA.P1.2', titre: 'Choisir une strat√©gie', domaine: 'P1', description: 'Plan de r√©solution' },
            { code: 'CE1.MA.P1.3', titre: 'R√©soudre un probl√®me', domaine: 'P1', description: 'Mise en ≈ìuvre' },
            { code: 'CE1.MA.P1.4', titre: 'V√©rifier sa solution', domaine: 'P1', description: 'Contr√¥le et validation' },
            { code: 'CE1.MA.P1.5', titre: 'Communiquer sa solution', domaine: 'P1', description: 'Explication, pr√©sentation' },
            
            // RAISONNEMENT (R1)
            { code: 'CE1.MA.R1.1', titre: 'D√©velopper un raisonnement logique', domaine: 'R1', description: 'Logique et d√©duction' },
            { code: 'CE1.MA.R1.2', titre: 'Utiliser des propri√©t√©s', domaine: 'R1', description: 'R√®gles et propri√©t√©s' },
            { code: 'CE1.MA.R1.3', titre: 'Justifier ses r√©ponses', domaine: 'R1', description: 'Argumentation' },
            { code: 'CE1.MA.R1.4', titre: 'Critiquer un raisonnement', domaine: 'R1', description: 'Validation, erreurs' },
            { code: 'CE1.MA.R1.5', titre: 'G√©n√©raliser des r√©sultats', domaine: 'R1', description: 'Extension, g√©n√©ralisation' },
            
            // COMMUNICATION (C1)
            { code: 'CE1.MA.C1.1', titre: 'Exprimer sa pens√©e math√©matique', domaine: 'C1', description: 'Communication orale' },
            { code: 'CE1.MA.C1.2', titre: 'Utiliser le vocabulaire math√©matique', domaine: 'C1', description: 'Termes sp√©cifiques' },
            { code: 'CE1.MA.C1.3', titre: 'Expliquer sa d√©marche', domaine: 'C1', description: 'M√©thode et proc√©dure' },
            { code: 'CE1.MA.C1.4', titre: '√âcouter et comprendre les autres', domaine: 'C1', description: 'Communication entre pairs' },
            { code: 'CE1.MA.C1.5', titre: 'Partager ses d√©couvertes', domaine: 'C1', description: '√âchange et collaboration' }
        ];
        
        // Insert CE1 French competencies
        console.log('\nüìö Inserting CE1 French competencies...');
        for (const comp of ce1FrenchCompetencies) {
            try {
                await connection.execute(`
                    INSERT INTO competences (id, code, titre, matiere, niveau, domaine, description, created_at)
                    VALUES (?, ?, ?, ?, ?, ?, ?, NOW())
                    ON DUPLICATE KEY UPDATE
                    titre = VALUES(titre),
                    description = VALUES(description),
                    created_at = NOW()
                `, [
                    comp.code,
                    comp.code,
                    comp.titre,
                    'FR',
                    'CE1',
                    comp.domaine,
                    comp.description
                ]);
            } catch (error) {
                console.log(`‚ö†Ô∏è  Skipped ${comp.code}: ${error.message}`);
            }
        }
        
        // Insert CE1 Math competencies
        console.log('\nüìö Inserting CE1 Math competencies...');
        for (const comp of ce1MathCompetencies) {
            try {
                await connection.execute(`
                    INSERT INTO competences (id, code, titre, matiere, niveau, domaine, description, created_at)
                    VALUES (?, ?, ?, ?, ?, ?, ?, NOW())
                    ON DUPLICATE KEY UPDATE
                    titre = VALUES(titre),
                    description = VALUES(description),
                    created_at = NOW()
                `, [
                    comp.code,
                    comp.code,
                    comp.titre,
                    'MA',
                    'CE1',
                    comp.domaine,
                    comp.description
                ]);
            } catch (error) {
                console.log(`‚ö†Ô∏è  Skipped ${comp.code}: ${error.message}`);
            }
        }
        
        // Verify results
        console.log('\nüîç Verifying results...');
        
        const [totalCount] = await connection.execute('SELECT COUNT(*) as count FROM competences');
        console.log(`üìä Total competencies in database: ${totalCount[0].count}`);
        
        const [levelCount] = await connection.execute(`
            SELECT niveau, COUNT(*) as count
            FROM competences 
            GROUP BY niveau
            ORDER BY niveau
        `);
        console.log('\nüéì Competencies by level:');
        levelCount.forEach(row => {
            console.log(`   ${row.niveau}: ${row.count}`);
        });
        
        const [subjectCount] = await connection.execute(`
            SELECT matiere, COUNT(*) as count
            FROM competences 
            GROUP BY matiere
            ORDER BY matiere
        `);
        console.log('\nüìñ Competencies by subject:');
        subjectCount.forEach(row => {
            console.log(`   ${row.matiere}: ${row.count}`);
        });
        
        console.log('\nüéâ CE1 and CE2 competencies populated successfully!');
        
    } catch (error) {
        console.error('‚ùå Population failed:', error.message);
    } finally {
        if (connection) {
            await connection.end();
            console.log('üîå Database connection closed');
        }
    }
}

// Run the population
populateCE1CE2Competencies().catch(console.error);


